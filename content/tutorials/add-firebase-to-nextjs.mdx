---
title: "Add Google's Firebase To Next.js Website"
description: "Learn how to connect Next.js to Google's Firebase and use authentication, cloud Firestore, Realtime Database, and cloud storage."
author: "Benjamin Carlson"
publishedAt: "2021-04-05"
featureImg: "feature.png"
youtubeId: ["https://youtu.be/SYnu6CLKD70", "https://youtu.be/mgyteUk1Wpc"]
githubURL: "https://github.com/bjcarlson42/nextjs-with-firebase"
tags: ["Firebase", "Nextjs"]
headings: ["Introduction", "Initialize Firebase"]
---

## Introduction

In this tutorial we will add Firebase to a Next.js website. If you are using another react based
framework, the process should be very similar and you should get something out of this tutorial.

We will first connect the website to Firebase (which is a step in itself), and then we'll add the following functionalities
in the following order:

- Authentication
- Cloud Firestore
- Realtime Database
- Storage

## Initialize Firebase

First, make sure you have a Firebase project. You can create one [here](https://console.firebase.google.com) if
you do not have one.

Create a folder called `firebase` and inside of that folder create a file called `initFirebase.js`. We will add
all our firebase related functionality inside of this folder.

Now, install the 2 dependancies:

```bash
yarn add firebase firebase-admin
```

Import these inside of `initFirebase.js`.

If you haven't already, create a web app inside of your Firebase project. Once you go through those steps,
you will be able to download your credentials. From here, create a file called .env and paste in the secrets.
Your file should look like mine (Except with your secret variables obviously!).

```bash
NEXT_PUBLIC_FIREBASE_API_KEY=
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=
NEXT_PUBLIC_FIREBASE_DATABASE_URL=
NEXT_PUBLIC_FIREBASE_PROJECT_ID=
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=
NEXT_PUBLIC_FIREBASE_APP_ID=

# for firebase-admin
FIREBASE_CLIENT_EMAIL=
FIREBASE_PRIVATE_KEY=
```

We can now use these secrets to initialize Firebase. Your `initFirebase` file should look like this:

```javascript:initFirebase.js
import firebase from 'firebase/app'
// the below imports are option - comment out what you don't need
import 'firebase/auth'
import 'firebase/firestore'
import 'firebase/storage'
import 'firebase/analytics'
import 'firebase/performance'

const clientCredentials = {
    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,
    authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,
    databaseURL: process.env.NEXT_PUBLIC_FIREBASE_DATABASE_URL,
    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,
    storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,
    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,
    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,
}
```

Lastly, let's export a function called `initFirebase()` that uses these credentials to initialize Firebase!

```javascript:initFirebase.js
export default function initFirebase() {
    if (!firebase.apps.length) {
        firebase.initializeApp(clientCredentials)
        // Check that `window` is in scope for the analytics module!
        if (typeof window !== 'undefined') {
            // Enable analytics. https://firebase.google.com/docs/analytics/get-started
            if ('measurementId' in clientCredentials) {
                firebase.analytics()
                firebase.performance()
            }
        }
        console.log('Firebase was successfully init.')
    }
}
```

Now that Firebase is initialized, we can begin to use it.

## Cloud Firestore

We will start off with cloud Firestore.

### Write

Create a folder named components. Inside of this folder, create a folder called
`cloudFirestore`. All of our cloud Firestore related components will go inside of here.
Inside of here, create a file named `write.js`. In here we will:

1. Import Firebase
2. Import cloud Firestore

Then, create a basic React component named `WriteToCloudFirestore`. Your file should look like this:

```javascript:Write.js
import firebase from 'firebase/app'
import 'firebase/firestore'

const WriteToCloudFirestore = () => {
    return (
        <div style={{ margin: '5px 0' }}>

        </div>
    )
}

export default WriteToCloudFirestore
```

To send data, we need to create a function `sendData`. We will then invoke this function on a button press.
We'll wrap it in a try catch loop as well.

```javascript:Write.js
import firebase from 'firebase/app'
import 'firebase/firestore'

const WriteToCloudFirestore = () => {
    const sendData = () => {
        try {
            // write data here
        } catch (error) {
            console.log(error)
            alert(error)
        }
    }

    return (
        <div style={{ margin: '5px 0' }}>
            <button onClick={sendData}>Send Data To Cloud Firestore</button>
        </div>
    )
}

export default WriteToCloudFirestore
```

To write data, we access the firestore method on the firebase object. We grab the collection called `myCollection`(can be any name you like),
we grad the document called `my_document`(can be any name you like), and then use the `set()` method. It looks something like this:

```javascript:Write.js
firebase
    .firestore()
    .collection('myCollection')
    .doc('my_document') // leave as .doc() for a random unique doc name to be assigned
    .set({
        string_data: 'Benjamin Carlson',
        number_data: 2,
        boolean_data: true,
        map_data: { stringInMap: 'Hi', numberInMap: 7 },
        array_data: ['text', 4],
        null_data: null,
        time_stamp: firebase.firestore.Timestamp.fromDate(new Date('December 17, 1995 03:24:00')),
        geo_point: new firebase.firestore.GeoPoint(34.714322, -131.468435)
    })
    .then(alert('Data was successfully sent to cloud firestore!'))
```

When we put it all together it looks like this:

```javascript:Write.js
import firebase from 'firebase/app'
import 'firebase/firestore'

const WriteToCloudFirestore = () => {
    const sendData = () => {
        try {
            firebase
                .firestore()
                .collection('myCollection')
                .doc('my_document') // leave as .doc() for a random unique doc name to be assigned
                .set({
                    string_data: 'Benjamin Carlson',
                    number_data: 2,
                    boolean_data: true,
                    map_data: { stringInMap: 'Hi', numberInMap: 7 },
                    array_data: ['text', 4],
                    null_data: null,
                    time_stamp: firebase.firestore.Timestamp.fromDate(new Date('December 17, 1995 03:24:00')),
                    geo_point: new firebase.firestore.GeoPoint(34.714322, -131.468435)
                })
                .then(alert('Data was successfully sent to cloud firestore!'))
        } catch (error) {
            console.log(error)
            alert(error)
        }
    }

    return (
        <button onClick={sendData}>Send Data To Cloud Firestore</button>
    )
}

export default WriteToCloudFirestore
```

Imort this component inside of `index.js` and press the button. You should see a success alert
and if you navigate to [Firbase](https://console.firebase.google.com) you should see the data.

![Write Success Image](/content/tutorials/add-firebase-to-nextjs/write-success.png)

### Read

Now let's read this data. Create a file named `Read.js` in the same folder as `Write.js`.
Make a component named `ReadDataFromCloudFirestore()`. Inside of it create a button, with
an onClick event which invokes a function named `readData`. Your file should look like this:

```javascript:Read.js
import firebase from 'firebase/app'
import 'firebase/firestore'

const ReadDataFromCloudFirestore = () => {
    const readData = () => {

    }

    return (
        <button onClick={readData}>Read Data From Cloud Firestore</button>
    )
}

export default ReadDataFromCloudFirestore
```

Now, inside of the method lets read the data by invoking the firestore() method off the firebase
object. Select the collection and the document the same way as before. Next, use the `onSnapshot`
method. Inide of it, create a function and console.log the data. The data is inside of doc.data(). The doc
object is the entire response. Here is the complete file:

```javascript:Read.js
import firebase from 'firebase/app'
import 'firebase/firestore'

const ReadDataFromCloudFirestore = () => {
    const readData = () => {
        try {
            firebase
                .firestore()
                .collection('myCollection')
                .doc('my_document')
                .onSnapshot(function (doc) {
                    console.log(doc.data())
                })
            alert('Data was successfully fetched from cloud firestore! Close this alert and check console for output.')
        } catch (error) {
            console.log(error)
            alert(error)
        }
    }

    return (
        <button onClick={readData}>Read Data From Cloud Firestore</button>
    )
}

export default ReadDataFromCloudFirestore
```

Import this function into `index.js` and you'll see your data in the console!
